<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Security Framework Compliance Dashboard | Microsoft Defender XDR</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Top Navigation Bar -->
  <nav class="top-nav" role="navigation" aria-label="Primary navigation">
    <div class="nav-brand">
      <svg class="nav-logo" width="20" height="20" viewBox="0 0 23 23" fill="none" aria-hidden="true">
        <rect width="11" height="11" fill="#f25022"/>
        <rect x="12" width="11" height="11" fill="#7fba00"/>
        <rect y="12" width="11" height="11" fill="#00a4ef"/>
        <rect x="12" y="12" width="11" height="11" fill="#ffb900"/>
      </svg>
      <span class="nav-title">Microsoft Defender XDR</span>
      <span class="nav-separator">|</span>
      <span class="nav-subtitle">Security Framework Compliance</span>
    </div>
    <div class="nav-actions">
      <button class="nav-btn" id="btn-connect-tenant" aria-label="Connect tenant">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
          <path d="M8 1a3 3 0 100 6 3 3 0 000-6zM3 12c0-2.2 2.2-4 5-4s5 1.8 5 4v1H3v-1z"/>
        </svg>
        <span>Connect Tenant</span>
      </button>
      <div class="tenant-indicator" id="tenant-indicator" hidden>
        <span class="tenant-dot"></span>
        <span class="tenant-name" id="tenant-name-display"></span>
      </div>
    </div>
  </nav>

  <!-- Tenant Connection Modal -->
  <div class="modal-overlay" id="modal-overlay" hidden>
    <div class="modal" role="dialog" aria-labelledby="modal-title" aria-modal="true">
      <div class="modal-header">
        <h2 id="modal-title">Connect Your Tenant</h2>
        <button class="modal-close" id="modal-close" aria-label="Close dialog">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Connect your Microsoft 365 tenant to evaluate compliance posture against security frameworks. The dashboard will map your Defender XDR configuration to ISO 27001, CIS Controls, and NIST CSF requirements.</p>

        <div class="form-group">
          <label for="tenant-id">Tenant ID</label>
          <input type="text" id="tenant-id" class="form-input" placeholder="e.g. contoso.onmicrosoft.com or GUID" autocomplete="off" />
          <span class="form-hint">Your Azure AD / Entra ID tenant identifier</span>
        </div>

        <div class="form-group">
          <label for="tenant-name">Display Name</label>
          <input type="text" id="tenant-name" class="form-input" placeholder="e.g. Contoso Ltd" autocomplete="off" />
          <span class="form-hint">Friendly name for this tenant</span>
        </div>

        <div class="form-group">
          <label for="auth-method">Authentication Method</label>
          <select id="auth-method" class="form-select">
            <option value="interactive">Interactive (Browser Sign-In)</option>
            <option value="service-principal">Service Principal (App Registration)</option>
            <option value="managed-identity">Managed Identity</option>
          </select>
          <span class="form-hint">How the dashboard authenticates to Microsoft Graph</span>
        </div>

        <div class="form-group" id="sp-fields" hidden>
          <label for="client-id">Application (Client) ID</label>
          <input type="text" id="client-id" class="form-input" placeholder="00000000-0000-0000-0000-000000000000" autocomplete="off" />
          <label for="client-secret" class="mt-sm">Client Secret</label>
          <input type="password" id="client-secret" class="form-input" placeholder="Client secret value" autocomplete="off" />
        </div>

        <fieldset class="form-group">
          <legend>Frameworks to Evaluate</legend>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="fw-iso27001" checked />
              <span>ISO 27001:2022</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="fw-cis" checked />
              <span>CIS Controls v8</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="fw-nist" checked />
              <span>NIST CSF 2.0</span>
            </label>
          </div>
        </fieldset>

        <div class="permissions-info">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="info-icon" aria-hidden="true">
            <path d="M8 1a7 7 0 100 14A7 7 0 008 1zm.5 3v1h-1V4h1zm-1 2.5h1v5h-1v-5z"/>
          </svg>
          <div>
            <strong>Required Permissions</strong>
            <p>SecurityEvents.Read.All, DeviceManagementConfiguration.Read.All, Policy.Read.All, Directory.Read.All</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="btn-cancel">Cancel</button>
        <button class="btn btn-primary" id="btn-connect">Connect &amp; Evaluate</button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Hero / Summary Section -->
    <section class="hero-section" aria-label="Compliance summary">
      <div class="hero-text">
        <h1>Security Framework Compliance</h1>
        <p>Centralised view of your Microsoft Defender XDR posture mapped against industry-leading security frameworks. Connect your tenant to get real-time compliance scoring.</p>
      </div>
      <div class="hero-stats" id="hero-stats">
        <div class="stat-card">
          <span class="stat-value" id="stat-overall">--</span>
          <span class="stat-label">Overall Score</span>
          <div class="stat-bar"><div class="stat-bar-fill" id="bar-overall" style="width:0%"></div></div>
        </div>
        <div class="stat-card">
          <span class="stat-value" id="stat-controls">--</span>
          <span class="stat-label">Controls Mapped</span>
        </div>
        <div class="stat-card">
          <span class="stat-value" id="stat-passing">--</span>
          <span class="stat-label">Passing</span>
        </div>
        <div class="stat-card stat-card--warn">
          <span class="stat-value" id="stat-failing">--</span>
          <span class="stat-label">Needs Attention</span>
        </div>
      </div>
    </section>

    <!-- Framework Cards Grid -->
    <section class="frameworks-section" aria-label="Security frameworks">
      <h2 class="section-title">Frameworks</h2>
      <div class="frameworks-grid">

        <!-- ISO 27001 Card -->
        <article class="framework-card" data-framework="iso27001">
          <div class="framework-card-header">
            <div class="framework-icon framework-icon--iso">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 2L3 7v10l9 5 9-5V7l-9-5zm0 2.18L18.36 7.5 12 10.82 5.64 7.5 12 4.18zM5 8.94l6 3.33V19.1l-6-3.33V8.94zm8 10.16v-6.83l6-3.33v6.83l-6 3.33z"/>
              </svg>
            </div>
            <div>
              <h3>ISO 27001:2022</h3>
              <span class="framework-badge">Information Security Management</span>
            </div>
          </div>
          <p class="framework-desc">International standard for information security management systems (ISMS). Maps 93 controls across organisational, people, physical, and technological domains.</p>
          <div class="framework-score">
            <div class="score-ring" id="ring-iso27001" data-score="0">
              <svg viewBox="0 0 36 36" class="score-svg">
                <path class="score-bg" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3"/>
                <path class="score-fill" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3" stroke-dasharray="0, 100"/>
              </svg>
              <span class="score-text">--%</span>
            </div>
            <div class="score-details">
              <span class="detail-row"><span class="dot dot--pass"></span> Compliant: <strong id="iso-pass">--</strong></span>
              <span class="detail-row"><span class="dot dot--partial"></span> Partial: <strong id="iso-partial">--</strong></span>
              <span class="detail-row"><span class="dot dot--fail"></span> Non-compliant: <strong id="iso-fail">--</strong></span>
            </div>
          </div>
          <a href="iso27001.html" class="framework-link">View Controls &rarr;</a>
        </article>

        <!-- CIS Controls Card -->
        <article class="framework-card" data-framework="cis">
          <div class="framework-card-header">
            <div class="framework-icon framework-icon--cis">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 16l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z"/>
              </svg>
            </div>
            <div>
              <h3>CIS Controls v8</h3>
              <span class="framework-badge">Center for Internet Security</span>
            </div>
          </div>
          <p class="framework-desc">Prioritised set of 18 top-level controls with 153 safeguards. Organised by Implementation Groups (IG1, IG2, IG3) for scalable adoption.</p>
          <div class="framework-score">
            <div class="score-ring" id="ring-cis" data-score="0">
              <svg viewBox="0 0 36 36" class="score-svg">
                <path class="score-bg" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3"/>
                <path class="score-fill" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3" stroke-dasharray="0, 100"/>
              </svg>
              <span class="score-text">--%</span>
            </div>
            <div class="score-details">
              <span class="detail-row"><span class="dot dot--pass"></span> Compliant: <strong id="cis-pass">--</strong></span>
              <span class="detail-row"><span class="dot dot--partial"></span> Partial: <strong id="cis-partial">--</strong></span>
              <span class="detail-row"><span class="dot dot--fail"></span> Non-compliant: <strong id="cis-fail">--</strong></span>
            </div>
          </div>
          <a href="cis.html" class="framework-link">View Controls &rarr;</a>
        </article>

        <!-- NIST CSF Card -->
        <article class="framework-card" data-framework="nist">
          <div class="framework-card-header">
            <div class="framework-icon framework-icon--nist">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"/>
              </svg>
            </div>
            <div>
              <h3>NIST CSF 2.0</h3>
              <span class="framework-badge">Cybersecurity Framework</span>
            </div>
          </div>
          <p class="framework-desc">Comprehensive cybersecurity framework with 6 core functions: Govern, Identify, Protect, Detect, Respond, and Recover. 106 subcategories of outcomes.</p>
          <div class="framework-score">
            <div class="score-ring" id="ring-nist" data-score="0">
              <svg viewBox="0 0 36 36" class="score-svg">
                <path class="score-bg" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3"/>
                <path class="score-fill" d="M18 2.0845a15.9155 15.9155 0 010 31.831 15.9155 15.9155 0 010-31.831" fill="none" stroke-width="3" stroke-dasharray="0, 100"/>
              </svg>
              <span class="score-text">--%</span>
            </div>
            <div class="score-details">
              <span class="detail-row"><span class="dot dot--pass"></span> Compliant: <strong id="nist-pass">--</strong></span>
              <span class="detail-row"><span class="dot dot--partial"></span> Partial: <strong id="nist-partial">--</strong></span>
              <span class="detail-row"><span class="dot dot--fail"></span> Non-compliant: <strong id="nist-fail">--</strong></span>
            </div>
          </div>
          <a href="nist.html" class="framework-link">View Controls &rarr;</a>
        </article>
      </div>
    </section>

    <!-- Cross-Framework Mapping Table -->
    <section class="mapping-section" aria-label="Cross-framework control mapping">
      <div class="section-header">
        <h2 class="section-title">Cross-Framework Control Mapping</h2>
        <div class="filter-bar">
          <input type="text" id="search-controls" class="form-input form-input--sm" placeholder="Search controls..." aria-label="Search controls" />
          <select id="filter-status" class="form-select form-select--sm" aria-label="Filter by status">
            <option value="all">All Statuses</option>
            <option value="pass">Compliant</option>
            <option value="partial">Partial</option>
            <option value="fail">Non-Compliant</option>
          </select>
          <select id="filter-product" class="form-select form-select--sm" aria-label="Filter by Defender product">
            <option value="all">All Products</option>
            <option value="mde">Defender for Endpoint</option>
            <option value="mdi">Defender for Identity</option>
            <option value="mdo">Defender for Office 365</option>
            <option value="mdca">Defender for Cloud Apps</option>
            <option value="mdvm">Vulnerability Management</option>
            <option value="xdr">XDR Portal</option>
          </select>
        </div>
      </div>
      <div class="table-container">
        <table class="mapping-table" id="mapping-table">
          <thead>
            <tr>
              <th>Defender Capability</th>
              <th>ISO 27001</th>
              <th>CIS Control</th>
              <th>NIST CSF</th>
              <th>Status</th>
              <th>Product</th>
            </tr>
          </thead>
          <tbody id="mapping-tbody">
            <!-- Populated by JavaScript -->
          </tbody>
        </table>
      </div>
      <p class="table-empty" id="table-empty" hidden>No controls match the current filters.</p>
    </section>

    <!-- Tenant Review Section -->
    <section class="review-section" aria-label="Tenant compliance review">
      <div class="section-header">
        <h2 class="section-title">Tenant Compliance Review</h2>
        <a href="tenant-review.html" class="framework-link">Full Review Guide &rarr;</a>
      </div>
      <div class="review-grid" id="review-grid">
        <div class="review-card">
          <div class="review-card-header">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="review-icon" aria-hidden="true">
              <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6z"/>
            </svg>
            <h3>Recommendations</h3>
          </div>
          <ul class="review-list" id="recommendations-list">
            <li class="review-placeholder">Connect a tenant to see recommendations</li>
          </ul>
        </div>

        <div class="review-card">
          <div class="review-card-header">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="review-icon" aria-hidden="true">
              <path d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 3.414L14.586 9H11V5.414zM7 11h6v1H7v-1zm0 3h4v1H7v-1z"/>
            </svg>
            <h3>Recent Assessments</h3>
          </div>
          <ul class="review-list" id="assessments-list">
            <li class="review-placeholder">No assessments yet</li>
          </ul>
        </div>

        <div class="review-card">
          <div class="review-card-header">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="review-icon" aria-hidden="true">
              <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm0 6a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2zm0 6a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"/>
            </svg>
            <h3>Deployment Actions</h3>
          </div>
          <ul class="review-list" id="actions-list">
            <li class="review-placeholder">Connect a tenant to see available actions</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- How-To: Admin Connection Guide -->
    <section class="guide-section" aria-label="Admin connection guide">
      <h2 class="section-title">Admin Guide: Connecting Your Tenant</h2>
      <div class="steps-grid">
        <div class="step-card">
          <div class="step-number">1</div>
          <h3>Register an App</h3>
          <p>In the Azure / Entra portal, create an App Registration with the required Microsoft Graph API permissions: <code>SecurityEvents.Read.All</code>, <code>DeviceManagementConfiguration.Read.All</code>, <code>Policy.Read.All</code>.</p>
        </div>
        <div class="step-card">
          <div class="step-number">2</div>
          <h3>Grant Admin Consent</h3>
          <p>A Global Administrator must grant tenant-wide admin consent for the requested permissions. Navigate to <strong>API Permissions &rarr; Grant admin consent</strong>.</p>
        </div>
        <div class="step-card">
          <div class="step-number">3</div>
          <h3>Connect via Dashboard</h3>
          <p>Click <strong>Connect Tenant</strong> above, enter your Tenant ID and select your authentication method. The dashboard will query Microsoft Graph to evaluate your Defender XDR configuration.</p>
        </div>
        <div class="step-card">
          <div class="step-number">4</div>
          <h3>Review &amp; Remediate</h3>
          <p>Review the compliance scores per framework. Drill into individual controls to see gaps, then use the provided PowerShell scripts in this repository to remediate findings.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <p>Microsoft Defender XDR &mdash; Security Framework Compliance Dashboard</p>
    <p class="footer-sub">Maps Defender capabilities to ISO 27001:2022, CIS Controls v8, and NIST CSF 2.0</p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
